<!DOCTYPE html>
<html lang="tr">

<head>
    <script>
        // HTTPS yönlendirmesi
        if (window.location.protocol !== "https:" && window.location.hostname !== "localhost" && window.location.hostname !== "127.0.0.1") {
            window.location.href = "https://" + window.location.host + window.location.pathname + window.location.search;
        }
    </script>

    <!-- Google Analytics izleme kodunu kullanıcı onayı olmadan yükleme -->
    <script>
        function loadAnalytics() {
            const script = document.createElement("script");
            script.async = true;
            script.src = "https://www.googletagmanager.com/gtag/js?id=G-LHZW1B9K3D";
            document.head.appendChild(script);

            script.onload = () => {
                window.dataLayer = window.dataLayer || [];
                function gtag() { dataLayer.push(arguments); }
                window.gtag = gtag;
                gtag('js', new Date());
                gtag('config', 'G-LHZW1B9K3D');
            };
        }

        function checkConsent() {
            const consent = localStorage.getItem("analytics_consent");
            if (consent === "accepted") {
                loadAnalytics();
            }
        }

        checkConsent();
    </script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" href="{{ '/assets/images/favicon.ico' | relative_url }}" type="image/x-icon" />
    <meta name="title" content="{{ page.title | default: site.title }}" />
    <meta name="description" content="{{ page.description | default: site.description }}" />
    <meta name="author" content="{{ page.author | default: site.author }}" />
    <meta name="robots" content="INDEX, FOLLOW" />
    <link rel="canonical" href="{{ site.url }}{{ page.url }}" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="{{ site.url }}{{ page.url }}" />
    <meta property="og:title" content="{{ page.title | default: site.title }}" />
    <meta property="og:description" content="{{ page.description | default: site.description }}" />
    <meta property="og:image" content="{{ site.url }}{{ '/assets/images/avatar.webp' | relative_url }}" />
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="{{ site.url }}{{ page.url }}" />
    <meta property="twitter:title" content="{{ page.title | default: site.title }}" />
    <meta property="twitter:description" content="{{ page.description | default: site.description }}" />
    <meta property="twitter:image" content="{{ site.url }}{{ '/assets/images/avatar.webp' | relative_url }}" />

    <title>{{ page.title | default: site.title }}</title>

    <link href="{{ '/assets/css/main.css' | relative_url }}" rel="stylesheet" />
    <style>
        html {
            background-color: #F1F5F9;
        }

        html.light {
            background-color: rgb(15 23 42);
        }

        [x-cloak] {
            display: none !important;
        }

        #cookie-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #1e293b;
            color: #fff;
            padding: 15px;
            text-align: center;
            font-size: 14px;
            z-index: 9999;
        }

        #cookie-banner button {
            margin-left: 10px;
            padding: 5px 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        #cookie-accept {
            background: #22c55e;
            color: #fff;
        }

        #cookie-reject {
            background: #ef4444;
            color: #fff;
        }
    </style>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const consent = localStorage.getItem("analytics_consent");
            if (!consent) {
                document.getElementById("cookie-banner").style.display = "block";
            }

            document.getElementById("cookie-accept").onclick = function () {
                localStorage.setItem("analytics_consent", "accepted");
                loadAnalytics();
                document.getElementById("cookie-banner").remove();
            };

            document.getElementById("cookie-reject").onclick = function () {
                localStorage.setItem("analytics_consent", "rejected");
                document.getElementById("cookie-banner").remove();
            };
        });
    </script>

    <!-- Tema tercihi -->
    <script>
        (function () {
            const isDark = localStorage.getItem('darkMode') === 'true';
            document.documentElement.classList.add(isDark ? 'dark' : 'light');
        })();
    </script>

    <script src="{{ '/assets/js/alpine.js' | relative_url }}" defer></script>


</head>

<body x-data="{ darkMode: localStorage.getItem('darkMode') === 'true', isOpen: false,  toggle() {
      this.darkMode = !this.darkMode;
      localStorage.setItem('darkMode', this.darkMode);
      document.documentElement.classList.toggle('dark', this.darkMode);
      document.documentElement.classList.toggle('light', !this.darkMode);
    }}" x-init="document.documentElement.classList.toggle('dark', darkMode);" x-cloak
    class="text-md md:text-xl grid grid-cols-1 justify-items-center min-h-screen pb-20"
    :class="{ 'text-black': darkMode, 'text-white': !darkMode }">

    {% include header.html %}

    <div class=" w-full flex flex-row justify-center ">
        <main id="main-content" class=" flex flex-row  justify-center w-4/5 md:p-5 md:w-3/4 lg:w-2/4"
            :class="{ 'text-black': darkMode, 'text-white': !darkMode }">
            {{ content }}

        </main>
    </div>

    {% include footer.html %}

    <!-- Çerez izin bannerı -->
    <div id="cookie-banner" style="display:none;">
        Bu site istatistikler için çerez kullanır. Kabul ediyor musunuz?
        <br>
        <button id="cookie-accept">Kabul Et</button>
        <button id="cookie-reject">Reddet</button>
    </div>

</body>

</html>
